

background: transparent;


content {
	position: absolute;
	top: 0;
	left: 0;
	right: 0;
	bottom: 0;
	--base: #7f0079;

	&:before {
		content: "";
		position: absolute;
		top: 0;
		left: 0;
		right: 0;
		bottom: 0;
		background: var( --base ) radial-gradient(circle at 50%, #ffffff33, transparent);
	}

	.witness-bg {
		position: absolute;
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
		border-radius: inherit;
		pointer-events: none;
		mix-blend-mode: overlay;
	}

	.game-view {
		position: absolute;
		top: 0;
		left: 0;
		right: 0;
		bottom: 0;
		overflow: hidden;
		// default puzzle variables
		--width: 4;
		--height: 4;
		--unit: 19px;
		--gap: 19px;
		--fat: 5;
		--cell: 83px;
		--cW: var( --cell );
		--cH: var( --cell );
		--base: #7f0079;
		--bg: #b900ac;
		--gr: #ff00f9;
		--fg: #8b08a2;
		--hl: #fff;
		--snake1: #fff;
		--snake2: #ff0;
		// defaults
		--c: #000;
		--d: 0;
	}
}

.level {
	position: absolute;
	top: 0;
	left: 0;
	right: 0;
	bottom: 0;
	// background: var( --base );
}

.puzzle {
	position: absolute;
	top: 60px;
	left: 60px;
	width: calc( var( --cW ) * var( --width ) );
	height: calc( var( --cH ) * var( --height ) );

	&:before {
		content: "";
		position: absolute;
		top: calc( var( --unit ) * -2 );
		left: calc( var( --unit ) * -2 );
		right: calc( var( --unit ) * -2 );
		bottom: calc( var( --unit ) * -2 );
		border-radius: calc( var( --unit ) * 1.75 );
		background: var( --bg ) radial-gradient(circle at 50%, var( --gr ), transparent);
		box-shadow: inset 0 0 23px rgba(#000,.35),
					0 2px 7px rgba(#000,.35);
	}

	&:after {
		content: "";
		position: absolute;
		top: calc( var( --unit ) * -1.6 );
		left: calc( var( --unit ) * -1.6 );
		right: calc( var( --unit ) * -1.6 );
		height: calc( var( --cH ) * .65 );
		background: linear-gradient(0deg, rgba(#fff,.2), rgba(#fff,.05));
		border-radius: calc( var( --unit ) * 1.35 );
		mix-blend-mode: soft-light;
		pointer-events: none;
		z-index: 3;
	}

	.grid-base {
		position: absolute;
		top: calc( var( --unit ) * -.5 );
		left: calc( var( --unit ) * -.5 );
		z-index: 2;
		filter: drop-shadow(0 1px 0 rgba(#fff,.125))
				 drop-shadow(0 -1px 0 rgba(#000,.3));
	}

	span {
		position: absolute;
		top: calc( var( --cH ) * var( --y ) );
		left: calc( var( --cW ) * var( --x ) );
		width: var( --unit );
		height: var( --unit );
		border-radius: var( --unit );

		&.ns {
			background: var( --fg );
			height: calc( var( --cH ) + var( --unit ) );
		}

		&.nsd {
			height: calc( var( --cH ) + var( --unit ) );

			&:before,
			&:after {
				content: "";
				background: var( --fg );
				position: absolute;
				left: 0;
				right: 0;
				height: calc( calc( var( --cH ) - var( --gap ) ) * .5 );
			}

			&:before { top: calc( var( --unit ) * .5 ); }
			&:after { bottom: calc( var( --unit ) * .5 ); }
		}

		&.we {
			background: var( --fg );
			width: calc( var( --cW ) + var( --unit ) );
		}

		&.wed {
			width: calc( var( --cW ) + var( --unit ) );

			&:before,
			&:after {
				content: "";
				background: var( --fg );
				position: absolute;
				top: 0;
				bottom: 0;
				width: calc( calc( var( --cW ) - var( --gap ) ) * .5 );
			}

			&:before { left: calc( var( --unit ) * .5 ); }
			&:after { right: calc( var( --unit ) * .5 ); }
		}

		&.start {
			&:before {
				content: "";
				position: absolute;
				top: calc( calc( var( --unit ) * -1 ) + 3px );
				left: calc( calc( var( --unit ) * -1 ) + 3px );
				right: calc( calc( var( --unit ) * -1 ) + 3px );
				bottom: calc( calc( var( --unit ) * -1 ) + 3px );
				border-radius: 50%;
				background: var( --fg );
				cursor: pointer;
			}

			&:after {
				content: "";
				position: absolute;
				top: calc( calc( var( --unit ) * -1 ) + 3px );
				left: calc( calc( var( --unit ) * -1 ) + 3px );
				right: calc( calc( var( --unit ) * -1 ) + 3px );
				bottom: calc( calc( var( --unit ) * -1 ) + 3px );
				border-radius: 50%;
				background: radial-gradient(circle, transparent, var( --hl ));
				animation: pulsate 1500ms ease-out infinite;
				mix-blend-mode: soft-light;
				pointer-events: none;
			}
		}

		&.exit {
			transform: rotate( calc( calc( var( --d ) * 45deg ) - 180deg ) );

			&:before {
				content: "";
				position: absolute;
				width: calc( var( --unit ) * 1 );
				height: calc( var( --unit ) * 2 );
				border-radius: var( --unit );
				background: var( --fg );
			}
		}

		&.dot {
			top: calc( calc( var( --cell ) * var( --y ) ) + calc( var( --cell ) * .2 ) );
			left: calc( calc( var( --cell ) * var( --x ) ) + calc( var( --cell ) * .2 ) );
			width: calc( var( --cell ) * .85 );
			height: calc( var( --cell ) * .85 );

			&:before {
				content: "";
				position: absolute;
				top: var( --unit );
				left: var( --unit );
				right: var( --unit );
				bottom: var( --unit );
				border-radius: calc( var( --unit ) * .6 );
				background: var(--c);
			}
		}

		&.star {
			top: calc( calc( var( --cell ) * var( --y ) ) + calc( var( --cell ) * .2 ) );
			left: calc( calc( var( --cell ) * var( --x ) ) + calc( var( --cell ) * .2 ) );
			width: calc( var( --cell ) * .85 );
			height: calc( var( --cell ) * .85 );

			&:before,
			&:after {
				content: "";
				position: absolute;
				top: calc( var( --unit ) * 1.2 );
				left: calc( var( --unit ) * 1.2 );
				right: calc( var( --unit ) * 1.2 );
				bottom: calc( var( --unit ) * 1.2 );
				background: var(--c);
			}

			&:after {
				transform: rotate(45deg);
			}
		}

		&.lambda {
			top: calc( calc( var( --cell ) * var( --y ) ) + calc( var( --cell ) * .2 ) );
			left: calc( calc( var( --cell ) * var( --x ) ) + calc( var( --cell ) * .2 ) );
			width: calc( var( --cell ) * .85 );
			height: calc( var( --cell ) * .85 );

			&:after {
				content: "";
				position: absolute;
				top: 0;
				left: 0;
				right: 0;
				bottom: 0;
				background: url(~/icons/icon-lambda.png) 50% 50% no-repeat;
				background-size: 35px 35px;
				filter: invert(1) brightness(1.5);
			}
		}
	}
}


@keyframes pulsate {
	0% { opacity: 1; transform: scale(.1); }
	80%,
	100% { opacity: 0; transform: scale(1); }
}
